<project name="project" default="main">

	<property name="workspace" value="${basedir}/../.." />
	<property name="inbox" value="${workspace}/_inbox" />
	<property environment="env" />

	<target name="main">
		<input message="Import BTM?"/>
		
		<antcall target=".untar"/>
		<antcall target=".moveSrc">
			<param name="project" value="BookmarkTree" />
			<param name="projectQualified" value="BookmarkTree" />
		</antcall>
		
		<antcall target=".cleanup"/>
	</target>
	
	<target name=".cleanup">
		
		<delete dir="${inbox}/zip"/>
		<delete dir="${inbox}/prj"/>
		
		<move todir="${inbox}">
			<fileset dir="${inbox}" includes="*.zip" />
			<mapper type="glob" from="*" to="*.done"/>
		</move>
		
		<eclipse.refreshLocal resource="_inbox"/>
		
	</target>
		
	<target name=".untar">
		<delete dir="${inbox}/zip"/>
		<delete dir="${inbox}/prj"/>
		<eclipse.refreshLocal resource="_inbox"/>
		<unzip dest="${inbox}/zip">
			<fileset dir="${inbox}" includes="*.zip"></fileset>
		</unzip>
		<eclipse.refreshLocal resource="_inbox"/>
	</target>

	<target name=".moveSrc" >
		<unzip dest="${inbox}/prj/${project}" src="${inbox}/zip/${project}.zip" />
		<eclipse.refreshLocal resource="_inbox"/>
		
		<delete dir="${workspace}/${projectQualified}/src/com">
			<include name="**/*.java" />
			<include name="**/*.xml" />
		</delete>
		<copy todir="${workspace}/${projectQualified}/src/com">
			<fileset dir="${inbox}/prj/${project}/src/com"></fileset>
		</copy>
		
		<condition property="resAvailable">
			<available file="${workspace}/${projectQualified}/res" />
		</condition>
		<antcall target=".moveRes"></antcall>
		
		<delete dir="${workspace}/${projectQualified}" includes="**/*BackupAgent*.java" />
		
		<eclipse.refreshLocal resource="${projectQualified}"/>
	
	</target>

	<target name=".moveRes" if="resAvailable">
		<delete dir="${workspace}/${projectQualified}/res">
			<include name="**/*.xml" />
		</delete>
		<copy todir="${workspace}/${projectQualified}/res">
			<fileset dir="${inbox}/prj/${project}/res"></fileset>
		</copy>
	</target>

</project>
