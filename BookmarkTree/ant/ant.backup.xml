<project name="project" default="backup">

	<property name="workspace" value="${basedir}/../.." />
	<property environment="env" />
	<property name="finaldir" value="d:\temp" />

	<property name="backupdir" value="${env.TEMP}\androidDevBackup" />
	<property name="prjdir" value="${backupdir}\projects" />

	<target name="backup">

		<tstamp>
			<format property="now" pattern="yyyyMMdd-HH.mm.ss" />
		</tstamp>
		<property name="zipname" value="btm-${now}.zip"/>

		<mkdir dir="${backupdir}" />
		
		<delete dir="${prjdir}" />
		<mkdir dir="${prjdir}" />
		
		<antcall target="zipProject"><param name="prjname" value="BookmarkTree"/></antcall>
		<zip destfile="${backupdir}/${zipname}" basedir="${prjdir}" update="true" />
		<delete dir="${prjdir}" />
		
		<move file="${backupdir}/${zipname}" todir="${finaldir}"/>
		
		<exec executable="explorer">
			<arg value="/select,"/>
			<arg value="${finaldir}\${zipname}"/>
		</exec>
		
	</target>

	<target name="zipProject">
		<zip destfile="${prjdir}/${prjname}.zip" basedir="${workspace}/${prjname}" update="true">
			<exclude name="**/*.class"/>
			<exclude name="**/.svn"/>
			<exclude name="**/*.class"/>
			<exclude name="**/*.apk"/>
			<exclude name="**/*.ap_"/>
			<exclude name="**/*.dex"/>
			<exclude name="**/R.java"/>
			<exclude name="**/keystore.properties"/>
		</zip>
	</target>
	
</project>
